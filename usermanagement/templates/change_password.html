{% extends "dashboard.html" %}

{% block title %}Change Password{% endblock %}
{% block page_title %}Change Your Password{% endblock %}

{% block breadcrumb_items %}
<li aria-current="page">
    <div class="flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
        <span class="ml-1 text-xs font-semibold text-blue-600 md:ml-2">Change Password</span>
    </div>
</li>
{% endblock %}

{% block content %}
<style>
    /* Custom keyframe animations for the notification service */
    @keyframes slide-in {
        from {
            transform: translateX(100%);
            opacity: 0;
        }
        to {
            transform: translateX(0);
            opacity: 1;
        }
    }

    @keyframes fade-out {
        from {
            transform: translateX(0);
            opacity: 1;
        }
        to {
            transform: translateX(100%);
            opacity: 0;
        }
    }

    .animate-slide-in {
        animation: slide-in 0.3s forwards;
    }

    .animate-fade-out {
        animation: fade-out 0.3s forwards;
    }

    /* Base styling for the global notification - positioned fixed */
    .global-notification-base {
        position: fixed;
        top: 20px; /* Distance from top */
        right: 20px; /* Distance from right */
        z-index: 1000; /* Ensure it's above other content */
        padding: 1rem 1.5rem;
        border-radius: 0.5rem;
        color: white;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        max-width: 350px; /* Limit width for better readability */
        min-width: 250px;
        display: flex; /* Hidden by default, JavaScript changes to 'flex' when showing */
        align-items: center;
        gap: 0.75rem; /* Space between icon and message */
        visibility: hidden; /* Use visibility for initial hidden state before animation */
        opacity: 0;
        transform: translateX(100%); /* Start off-screen to the right */
    }
</style>

<div class="bg-white rounded-lg shadow-sm p-5 md:p-6 border border-gray-100 animate-fade-in max-w-lg mx-auto">
    <div class="text-center mb-6 pb-3 border-b border-gray-100">
        <h2 class="text-2xl md:text-3xl font-extrabold text-gray-800 mb-1 flex items-center justify-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-blue-700" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15 7a2 2 0 012 2v5a2 2 0 01-2 2h-5a2 2 0 01-2-2V9a2 2 0 012-2h5z" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M17 9v-2a2 2 0 00-2-2H9a2 2 0 00-2 2v2" />
            </svg>
            Change Your Password
        </h2>
        <p class="text-gray-600 text-sm max-w-xl mx-auto">Update your account password for enhanced security.</p>
    </div>

    <form id="changePasswordForm" class="space-y-6">
        {% csrf_token %} {# Django's CSRF token for security #}

        <div>
            <label for="old_password" class="block text-sm font-medium text-gray-700 mb-1">Current Password</label>
            <input type="password" id="old_password" name="old_password" required
                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            <p id="old_password_error" class="text-red-500 text-xs mt-1 hidden"></p>
        </div>

        <div>
            <label for="new_password" class="block text-sm font-medium text-gray-700 mb-1">New Password</label>
            <input type="password" id="new_password" name="new_password" required
                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            <p id="new_password_error" class="text-red-500 text-xs mt-1 hidden"></p>
        </div>

        <div>
            <label for="confirm_new_password" class="block text-sm font-medium text-gray-700 mb-1">Confirm New Password</label>
            <input type="password" id="confirm_new_password" name="confirm_new_password" required
                   class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
            <p id="confirm_new_password_error" class="text-red-500 text-xs mt-1 hidden"></p>
        </div>

        <div>
            <button type="submit" id="submitButton"
                    class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200">
                Change Password
            </button>
        </div>
    </form>
</div>

<div id="global-notification" class="global-notification-base">
    <div id="notification-icon" class="flex-shrink-0">
        </div>
    <div id="notification-message" class="text-sm font-medium flex-grow">
        </div>
</div>
{% block extra_head %}
{# Load JavaScript modules using 'type="module"' #}
{% load static %}
<script src="{% static 'js/changePasswordForm.js' %}" type="module" ></script>
{% comment %} <script src="{% static 'js/notificationService.js' %}" type="module" defer></script> {% endcomment %}

{% endblock %}
{% endblock %}