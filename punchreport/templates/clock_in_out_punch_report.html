{% extends 'dashboard.html' %}

{% block title %}Employee Clock Data Report{% endblock %}

{% block content %}
    <div class="container mx-auto p-6">
        <h1 class="text-2xl font-extrabold text-gray-900 mb-6 flex items-center">
            <svg class="w-8 h-8 mr-3 text-blue-600" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M10 2a8 8 0 100 16 8 8 0 000-16zM5.293 9.293a1 1 0 011.414 0L10 12.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path>
            </svg>
            Employee Clock Data Report (Admin)
        </h1>

        <div class="mb-8 bg-white p-6 rounded-xl shadow-lg flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0 md:space-x-6">
            <div class="flex-grow">
                <label for="payPeriodSelector" class="block text-gray-700 text-sm font-semibold mb-2">Select Pay Period:</label>
                <div class="relative">
                    <select id="payPeriodSelector" class="appearance-none shadow border border-gray-300 rounded-lg w-full py-2.5 px-4 pr-10 text-gray-800 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 cursor-pointer">
                        <option value="">Loading Pay Periods...</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-700">
                        <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                    </div>
                </div>
            </div>
            <button id="exportExcelButton" class="min-w-max bg-green-600 hover:bg-green-700 text-white font-bold py-2.5 px-6 rounded-lg shadow-md transition-colors duration-200 ease-in-out flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none" disabled>
                <svg class="w-5 h-5 mr-2 -ml-1" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M3 17a1 1 0 01-1-1V6a1 1 0 011-1h5.172a2 2 0 011.414.586L12 7h4a1 1 0 011 1v6a1 1 0 01-1 1H3zm13-9V6H3v8h13V8zM5 9h1a1 1 0 010 2H5V9zm0 3h1a1 1 0 010 2H5v-2z" clip-rule="evenodd"></path>
                    <path d="M10.293 15.293a1 1 0 011.414 0l2 2a1 1 0 01-1.414 1.414l-1.293-1.293V19a1 1 0 11-2 0v-2.586l-1.293 1.293a1 1 0 01-1.414-1.414l2-2z" />
                </svg>
                Export to Excel
            </button>
        </div>

        <div id="clockDataReportContainer" class="bg-white p-6 rounded-xl shadow-lg">
            <p class="text-gray-500 text-center py-8">Select a pay period to view the clock data report.</p>
        </div>
    </div>

{% comment %} <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script> {% endcomment %}
{% load static %}
<script type="module" src="{% static 'punchreport/js/timeclock_punch.js' %}"></script>
{% endblock %}