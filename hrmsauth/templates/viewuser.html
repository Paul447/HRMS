{% extends "base.html" %}

{% block content %}
    <h1>User Details</h1>
    <table id="usersTable">
        <thead>
            <tr>
                <th>Username</th>
                <th>Email</th>
                <th>Is Staff</th>
                <th>Is Superuser</th>
                <th>Date Joined</th>
                <th>Last Login</th>
            </tr>
        </thead>
        <tbody>
            <!-- User rows will be injected here -->
        </tbody>
    </table>

    <script>
        fetch("/api/users/")
            .then(response => response.json())
            .then(data => {
                const tableBody = document.querySelector("#usersTable tbody");
                data.forEach(user => {
                    const row = `
                        <tr>
                            <td>${user.username}</td>
                            <td>${user.email || '-'}</td>
                            <td>${user.is_staff}</td>
                            <td>${user.is_superuser}</td>
                            <td>${new Date(user.date_joined).toLocaleString()}</td>
                            <td>${user.last_login ? new Date(user.last_login).toLocaleString() : '-'}</td>
                        </tr>
                    `;
                    tableBody.insertAdjacentHTML('beforeend', row);
                });
            })
            .catch(error => {
                console.error("Error fetching user data:", error);
            });
    </script>
{% endblock %}
